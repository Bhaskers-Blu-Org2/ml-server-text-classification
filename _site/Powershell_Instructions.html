<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="shortcut icon" type="image/png" href="images/favicon.png">
    <title>PowerShell Instructions</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Use SQL Server 2017 + ML Services with Python to execute a transfer learning algorithm to detect image similarity.">
    <meta name="author" content="Microsoft">

    <!-- Le styles -->
    <link href="stylesheets/bootstrap.min.css" rel="stylesheet"/>

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="stylesheets/mystyles.css">

  </head>
  <body> 
    <div class="container">
      <div class="row">
        <div class="col-sm-9">
          <div class="jumboton teal">
            <h1>Image Similarity</h1>
            <p>Implemented with Microsoft Machine Learning Services</p>
          </div>
              <div class="content">
                <h2 id="powershell-instructions">PowerShell Instructions</h2>
<hr />

<div class="row">
    <div class="col-md-6">
        <div class="toc">
            <li> <a href="#setup">Setup</a></li>
            <li> <a href="#execute-powershell-script">Execute PowerShell Script</a></li>
            <li> <a href="#score-production-data">Score Production Data</a></li>
            <li> <a href="#review-data">Review Data</a></li>
            <li> <a href="#visualizing-results">Visualizing Results</a> </li>
            <li> <a href="#other-steps">Other Steps</a></li>
        </div>
    </div>
    <div class="col-md-6">
        If you have deployed a VM through the  
        <a href="http://aka.ms/image-similarity">Azure AI Gallery</a>, all the steps below have already been performed and your database on that machine has all the resulting tables and stored procedures.  You can explore this solution in more detail by examining the folders and running Python or stored procedures to re-create the model, or skip to trying out the model in the included [Jupyter notebook](jupyter.html).
    </div>
</div>

<p>If you are configuring your own server, continue with the steps below to run the PowerShell script.</p>

<h2 id="setup">Setup</h2>
<hr />

<p>First, make sure you have set up your SQL Server by  <a href="SetupSQL.html">following these instructions</a>.  Then proceed with the steps below to run the solution template using the automated PowerShell file.</p>

<h2 id="execute-powershell-script">Execute PowerShell Script</h2>
<hr />

<p>Running this PowerShell script will create the data tables and stored procedures for the the operationalization of this solution in R in the <code class="highlighter-rouge">ImageSimilarity</code> database.  It will also execute these procedures to create full database with results of the steps  – dataset creation, modeling, and scoring as described  <a href="dba.html">here</a>.</p>

<ol>
  <li>
    <p>Log onto the machine that contains the SQL Server you wish to use.</p>
  </li>
  <li>
    <p>Download  <a href="https://raw.githubusercontent.com/Microsoft/r-server-campaign-optimization/master/Resources/ActionScripts/SetupVM.ps1" download="">SetupVM.ps1</a> to your computer.</p>
  </li>
  <li>
    <p>Right click on SetupVM.ps1 and select <code class="highlighter-rouge">Run with PowerShell</code>.</p>
  </li>
  <li>
    <p>Answer <code class="highlighter-rouge">Y</code> if asked if it is ok to execute this script.</p>
  </li>
  <li>
    <p>This will make the following modification to your SQL Server:`</p>
    <ul>
      <li>Creates the SLQRUserGroup for running R and Python code.</li>
      <li>Reconfigures SQL Server to allow running of external scripts.</li>
      <li>Installs the latest SQL Server 2017 Cumulative Update if no updates have been installed (this solution requires at least CU1 to run successfully).</li>
      <li>Clones the solution code and data into the c:\Solutions\ImageSimilarity directory.</li>
      <li>Installs the image_similarity Python package.</li>
      <li>Creates the solution database <code class="highlighter-rouge">ImageSimilarity</code></li>
      <li>Enables FILESTREAM at the SQL instance level as described <a href="https://docs.microsoft.com/en-us/sql/relational-imagesbases/blob/enable-the-prerequisites-for-filetable">here</a>.</li>
      <li>Copies images to the configured filestream directory.</li>
      <li>Copies the Resnet model needed for this solution into the correct directory.d</li>
    </ul>
  </li>
</ol>

<h2 id="review-data">Review Data</h2>
<hr />

<p>Once the PowerShell script has completed successfully, log into the SQL Server Management Studio to view all the datasets that have been created in the <code class="highlighter-rouge">ImageSimilarity_Py</code> databases.<br />
Hit <code class="highlighter-rouge">Refresh</code> if necessary.
<br /></p>

<p><a href="tables.html">Click here</a> to view the details all tables created in this solution.</p>

<h2 id="trying-the-model">Trying the Model</h2>
<hr />

<p>You’ve now finsihed the process of featurizing images using pre-trained DNN model, preparing the training/testing/evaluation image set, training a multi-class classifier and saving the model into SQL table as <a href="data-scientist.html">described here</a>.</p>

<p>This PowerShell script also created the stored procedures to perform these tasks as well as a procedure that can be used to  return top K similar candidates for new query images.</p>

<p>You can explore this solution in more detail by examining the folders and running Python or stored procedures to re-create the model, or skip to trying out the model in the included <strong>Test Model.ipynb</strong> <a href="jupyter.html">Jupyter notebook</a>.</p>

              </div>  
          </div><!--/col -->

        <div class="col-sm-3 sidebar-offcanvas" id="sidebar">
          <img  src="images/TextAnalysis.png">
          <div class="list-group">
          <a href="index.html" class="list-group-item">Home</a>
					<a href="data-scientist.html" class="list-group-item">For the Data Scientist</a>
          <a href="dba.html" class="list-group-item">For the Database Analyst</a>
					<a href="quick.html" class="list-group-item">Quick Start</a>
				  </div>
        <hr />
            <div class="center">
            <a  class="btn btn-large btn-info" href="https://github.com/Microsoft/ml-server-image-similarity">
            View On <strong>GitHub</strong></a>
            </div>
            <hr />
            <p class="details">Other Links</p>
              <div class="toc">
                <li><a href="contents.html">Packet Contents</a></li>
                <li><a href="sitemap.html">Site Map</a></li>

            </div>
          </div><!--/col -->
      </div><!-- /row -->

<div class="row">
  <hr />
      <footer>
        <p> 
This project has adopted the <a href="https://opensource.microsoft.com/codeofconduct/">Microsoft Open Source Code of Conduct</a>. For more information see the <a href="https://opensource.microsoft.com/codeofconduct/faq/">Code of Conduct FAQ</a> or contact <a href="mailto:opencode@microsoft.com">opencode@microsoft.com</a> with any additional questions or comments.</p>
        <p><small>Hosted on GitHub Pages</small> </p>
      </footer>
  </div>
  
</div><!-- /container -->

<script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-88854735-5', 'auto');
  ga('send', 'pageview');

</script>
    

  </body>
</html>